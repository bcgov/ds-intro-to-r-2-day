<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>BC Migration Patterns</title>
<meta name="description" content="Now it is your turn to take all of the tools you have learned over the course and put them into practice. Below are some prompts and tips to guide you through a short analysis on international and...">
<meta name="generator" content="bookdown 0.32 with bs4_book()">
<meta property="og:title" content="BC Migration Patterns">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bcgov.github.io/ds-intro-to-r-2-day/bc-migration-patterns.html">
<meta property="og:description" content="Now it is your turn to take all of the tools you have learned over the course and put them into practice. Below are some prompts and tips to guide you through a short analysis on international and...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BC Migration Patterns">
<meta name="twitter:description" content="Now it is your turn to take all of the tools you have learned over the course and put them into practice. Below are some prompts and tips to guide you through a short analysis on international and...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">BC Migration Patterns</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li class="book-part">Fundamentals</li>
<li><a class="" href="introduction-to-r-and-rstudio.html"><span class="header-section-number">1</span> Introduction to R and RStudio</a></li>
<li><a class="" href="seeking-help-in-r.html"><span class="header-section-number">2</span> Seeking Help in R</a></li>
<li><a class="" href="project-management-with-rstudio.html"><span class="header-section-number">3</span> Project Management With RStudio</a></li>
<li><a class="" href="data-structures.html"><span class="header-section-number">4</span> Data Structures</a></li>
<li><a class="" href="manipulating-data-frames-with-dplyr.html"><span class="header-section-number">5</span> Manipulating Data Frames with dplyr</a></li>
<li><a class="" href="creating-publication-quality-graphics-with-ggplot2.html"><span class="header-section-number">6</span> Creating Publication-Quality Graphics with ggplot2</a></li>
<li><a class="" href="create-tidy-data-with-tidyr.html"><span class="header-section-number">7</span> Create Tidy Data with tidyr</a></li>
<li><a class="" href="joining-related-data.html"><span class="header-section-number">8</span> Joining Related Data</a></li>
<li class="book-part">Beyond the Fundamentals</li>
<li><a class="" href="subsetting-data-frames.html"><span class="header-section-number">9</span> Subsetting Data Frames</a></li>
<li><a class="" href="introduction-to-the-bcdata-package.html"><span class="header-section-number">10</span> Introduction to the bcdata package</a></li>
<li><a class="" href="data-analysis-reports.html"><span class="header-section-number">11</span> Data analysis reports</a></li>
<li><a class="" href="applications-of-r-markdown.html"><span class="header-section-number">12</span> Applications of R Markdown</a></li>
<li><a class="" href="seeking-help-from-others-with-reprex.html"><span class="header-section-number">13</span> Seeking Help from Others with reprex</a></li>
<li class="book-part">Examples and Extra Practice</li>
<li><a class="active" href="bc-migration-patterns.html">BC Migration Patterns</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/bcgov/ds-intro-to-r-2-day">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="bc-migration-patterns" class="section level1 unnumbered">
<h1>BC Migration Patterns<a class="anchor" aria-label="anchor" href="#bc-migration-patterns"><i class="fas fa-link"></i></a>
</h1>
<p>Now it is your turn to take all of the tools you have learned over the course and put them into practice.
Below are some prompts and tips to guide you through a short analysis on international and inter-provincial migration in B.C.
<em>Try to come up with your own solutions before looking at the hints and possible solutions provided</em>.</p>
<p>The migration data is publicly available in the BC Data Catalogue but we have also provided it in csv format in the data folder.</p>
<div id="setting-up-your-r-session" class="section level2" number="13.3">
<h2>
<span class="header-section-number">13.3</span> Setting up your R session<a class="anchor" aria-label="anchor" href="#setting-up-your-r-session"><i class="fas fa-link"></i></a>
</h2>
<p>As discussed in <strong>Chapter 1: Introduction to R and RStudio,</strong> before starting any analysis in R, make sure you have the necessary packages installed and loaded.
For this work you will need to make use of the readr, dplyr, tidyr and ggplot2 packages.
There will also be an opportunity to use the bcdata package to explore the BC Data Catalogue.</p>
<blockquote>
<details><summary>
Installing packages if necessary
</summary><div class="sourceCode" id="cb561"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"readr"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"tidyr"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"bcdata"</span><span class="op">)</span></span></code></pre></div>
</details>
</blockquote>
<blockquote>
<details><summary>
Loading packages
</summary><div class="sourceCode" id="cb562"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bcgov.github.io/bcdata/">bcdata</a></span><span class="op">)</span></span></code></pre></div>
</details>
</blockquote>
</div>
<div id="loading-data" class="section level2" number="13.4">
<h2>
<span class="header-section-number">13.4</span> Loading data<a class="anchor" aria-label="anchor" href="#loading-data"><i class="fas fa-link"></i></a>
</h2>
<p>Next load the data that you will be working with.
For this analysis you will be working with international and inter-provincial migration data.
This data has been provided for you in the data folder, but it is also available from the BC Data Catalogue.
For added practice consider using the bcdata package to import the data.</p>
<p>For a refresher on reading data from a csv file, check out <strong>Chapter 4: Data Structures</strong></p>
<blockquote>
<details><summary>
Hint 1
</summary>
Use the read_csv function
</details>
</blockquote>
<blockquote>
<details><summary>
Hint 2
</summary><p>Review the help pages if needed</p>
<div class="sourceCode" id="cb563"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">read_csv</span></span></code></pre></div>
</details>
</blockquote>
<blockquote>
<details><summary>
Possible Solution
</summary><div class="sourceCode" id="cb564"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">international</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/international_migration.csv"</span><span class="op">)</span></span>
<span><span class="va">interprovincial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/interprovincial_migration.csv"</span><span class="op">)</span></span></code></pre></div>
</details>
</blockquote>
<p>For an added challenge, consider importing the data directly from the BC Data Catalogue as discussed in <strong>Chapter 10: Introduction to the bcdata package</strong></p>
<blockquote>
<details><summary>
Hint 1
</summary><p>Use the bcdc_search function to search the data catalogue for records relating to migration</p>
<div class="sourceCode" id="cb565"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://bcgov.github.io/bcdata/reference/bcdc_search.html">bcdc_search</a></span><span class="op">(</span><span class="st">"migration"</span><span class="op">)</span></span></code></pre></div>
</details>
</blockquote>
<blockquote>
<details><summary>
Hint 2
</summary><p>The first title from the resulting search Inter-provincial and International migration (csv) sounds correct.
Use the record ID to find the IDs for the desired data sets (or resources).</p>
<div class="sourceCode" id="cb566"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">migration_resources</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bcgov.github.io/bcdata/reference/bcdc_tidy_resources.html">bcdc_tidy_resources</a></span><span class="op">(</span><span class="st">'56610cfc-02ba-41a7-92ef-d9609ef507f1'</span><span class="op">)</span></span>
<span><span class="va">migration_resources</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">id</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 6 × 2
  name                                  id                                  
  &lt;chr&gt;                                 &lt;chr&gt;                               
1 interprovincial_migration             95579825-bfa2-4cab-90fa-196e0ecc8626
2 international_migration               c99d63f6-5ec4-4ac0-9c07-c0352f2f1928
3 international_migration_annual        a8c186bb-857c-4138-8605-103c05411563
4 interprovincial_migration_annual      f6171cc3-3845-40dd-9855-d87e8f524064
5 interprovincial_migration_census_year 827c7f61-39bc-403f-8cf0-51fca5daef32
6 international_migration_census_year   773cc273-4456-4441-b040-ab0d03c7d5e9</code></pre>
</details>
</blockquote>
<blockquote>
<details><summary>
Possible Solution
</summary><p>Import the first two resources, interprovincial_migration and international_migration.</p>
<div class="sourceCode" id="cb568"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">international</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bcgov.github.io/bcdata/reference/bcdc_get_data.html">bcdc_get_data</a></span><span class="op">(</span>record <span class="op">=</span> <span class="st">"56610cfc-02ba-41a7-92ef-d9609ef507f1"</span>,</span>
<span>                         resource <span class="op">=</span> <span class="st">"c99d63f6-5ec4-4ac0-9c07-c0352f2f1928"</span><span class="op">)</span></span>
<span>                         </span>
<span><span class="va">interprovincial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bcgov.github.io/bcdata/reference/bcdc_get_data.html">bcdc_get_data</a></span><span class="op">(</span>record <span class="op">=</span> <span class="st">"56610cfc-02ba-41a7-92ef-d9609ef507f1"</span>,</span>
<span>                     resource <span class="op">=</span> <span class="st">"95579825-bfa2-4cab-90fa-196e0ecc8626"</span><span class="op">)</span></span></code></pre></div>
</details>
</blockquote>
</div>
<div id="reviewing-the-data" class="section level2" number="13.5">
<h2>
<span class="header-section-number">13.5</span> Reviewing the data<a class="anchor" aria-label="anchor" href="#reviewing-the-data"><i class="fas fa-link"></i></a>
</h2>
<p>When working with new data, it is best practices to take some time to review and understand it.
Use the functions you learned in <strong>Chapter 5: Manipulating Data Frames with dplyr</strong> to find the size and various other attributes of the data.</p>
<blockquote>
<details><summary>
Hint 1
</summary><ul>
<li>What are the columns in the international migration data, how are they related?</li>
<li>What are the columns in the inter-provincial migration data, how are they related?</li>
<li>How does the structure of the inter-provincial data differ from the international data?</li>
<li>What is the frequency of the data (Annual, Quarterly, Monthly, etc.)?</li>
<li>Is there anything else worth noting?</li>
</ul></details>
</blockquote>
<blockquote>
<details><summary>
Hint 2
</summary>
Consider using some of the following functions: <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>, <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code>, <code><a href="https://rdrr.io/r/base/dim.html">dim()</a></code>, <code><a href="https://rdrr.io/r/base/nrow.html">nrow()</a></code>, <code><a href="https://rdrr.io/r/base/names.html">names()</a></code>, <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>
</details>
</blockquote>
<blockquote>
<details><summary>
Possible Solution
</summary><p><strong>International migration data:</strong></p>
<ul>
<li>The international migration data has 204 rows and 8 columns.</li>
<li>The data is recorded quarterly from 1971 to 2022.</li>
<li>The column names are Year, Quarter, Immigrants, Emigrants, Net_non_permanent_residents, Net_temporary_emigrants, Returning_emigrants, Net_migration.</li>
<li>The column Net_migration can be calculated from the other columns as: <code>Net_migration = Immigrants - Emigrants + Net_non_permanent_residents - Net_temporary_emigrants + Returning_emigrants</code>
</li>
<li>This dataframe only contains values for B.C.</li>
</ul>
<p><strong>Inter-provincial migration data:</strong></p>
<ul>
<li>The inter-provincial migration data has 2,572 rows and 17 observations.</li>
<li>The data is also recorded quarterly from 1971 to 2022.</li>
<li>The column names are Year, Quarter, Origin, Acronyms of the 10 provinces and 3 territories, Total.</li>
<li>This data is set up in a crosstab structure where, for example, a value in a row with Origin = “B.C.” in the column “N.L.” represents the number of people that migrated from B.C. to N.L. in that year and quarter.</li>
<li>The Total column is equal to the sum of all of the provincial/territorial columns and represents the total number of people that migrated “OUT” of the province/territory listed in the Origin column for that year and quarter.</li>
<li>This dataframe contains all of the inter-provincial migration across Canada.</li>
</ul></details>
</blockquote>
</div>
<div id="analyzing-your-data" class="section level2" number="13.6">
<h2>
<span class="header-section-number">13.6</span> Analyzing your data<a class="anchor" aria-label="anchor" href="#analyzing-your-data"><i class="fas fa-link"></i></a>
</h2>
<p>Now that you are familiar with your data, it is time to do some analysis.
There is many different directions you can take but for this example we are going to look at the annual net migration of B.C.
since 2010 to see if there are any interesting patterns.
Let’s break this down into three parts: net international migration, net inter-provincial migration and total net migration.</p>
<div id="net-international-migration-from-2010-to-2021-annually" class="section level3" number="13.6.1">
<h3>
<span class="header-section-number">13.6.1</span> Net international migration from 2010 to 2021 annually<a class="anchor" aria-label="anchor" href="#net-international-migration-from-2010-to-2021-annually"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Plot the net international migration that occurred in B.C. from 2010 to 2021 annually.</strong></p>
<p>Where do you start?
Is this data available already, or does the data need to be manipulated?
Use the tools you learned from <strong>Chapter 5: Manipulating Data Frames with dplyr</strong> and then make an attractive plot using the tools from <strong>Chapter 6: Creating Publication-Quality Graphics with ggplot2</strong>.
Make sure to add labels and play around with theme elements to get your desired look.</p>
<blockquote>
<details><summary>
Hint (part 1)
</summary>
You will need to manipulate the data before plotting.
Consider the which years are to be plotted and the frequency.
Consider what column/columns contain the most relevant data.
</details>
</blockquote>
<blockquote>
<details><summary>
Possible Solution (part 1)
</summary><p>Filter the data for the correct years to be included (greater than or equal to 2010 but less than 2022).
To get the annual amount, group by year and sum Net_migration.</p>
<div class="sourceCode" id="cb569"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data_net_international</span> <span class="op">&lt;-</span> <span class="va">international</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">&gt;=</span> <span class="fl">2010</span>, <span class="va">Year</span> <span class="op">&lt;</span> <span class="fl">2022</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>Net_international <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Net_migration</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details>
</blockquote>
<blockquote>
<details><summary>
Hint (part 2)
</summary><p>Start with a basic plot.
What is the mapping?
What geom would work best?</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="bc-migration-patterns.html#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot_data_net_international, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ??, <span class="at">y =</span> ??)) <span class="sc">+</span></span>
<span id="cb570-2"><a href="bc-migration-patterns.html#cb570-2" aria-hidden="true" tabindex="-1"></a>geom_??</span></code></pre></div>
</details>
</blockquote>
<blockquote>
<details><summary>
Possible Solution (part 2)
</summary><p>Here is a possible plot.
Try to make your plot even more polished/customized.</p>
<div class="sourceCode" id="cb571"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">plot_data_net_international</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Net_international</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Net international migration in B.C."</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Annually from 2010 to 2021"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<img src="fig/rmd-13-unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;"></details>
</blockquote>
</div>
<div id="net-inter-provincial-migration-from-2010-to-2021-annually" class="section level3" number="13.6.2">
<h3>
<span class="header-section-number">13.6.2</span> Net inter-provincial migration from 2010 to 2021 annually<a class="anchor" aria-label="anchor" href="#net-inter-provincial-migration-from-2010-to-2021-annually"><i class="fas fa-link"></i></a>
</h3>
<p>Did you discover any interesting trends in international migration?
Do you think similar trends occurred among inter-provincial migration?</p>
<p><strong>Plot the net inter-provincial migration that occurred in B.C. from 2010 to 2021 annually.</strong></p>
<p>How does your approach differ using the inter-provincial data compared to the international data?
It may be helpful to consider the tools you learned in <strong>Chapter 8: Joining Related Data</strong>.</p>
<blockquote>
<details><summary>
Hint 1
</summary>
Net inter-provincial migration is not provided in the inter-provincial data so you will need to calculate it.
Consider how you would manipulate the data to get the total “IN” migration to B.C., then consider how you would get the total “OUT” migration from B.C.
</details>
</blockquote>
<blockquote>
<details><summary>
Hint 2
</summary>
The column B.C. in the data represents all of the migration “IN” to B.C.
The Total column represents the total amount of “OUT” for the province/territory listed in the Origin column.
</details>
</blockquote>
<blockquote>
<details><summary>
Possible Solution
</summary><p>Calculate the annual “IN” migration with the following:</p>
<div class="sourceCode" id="cb572"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">in_prov</span> <span class="op">&lt;-</span> <span class="va">interprovincial</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">&gt;=</span> <span class="fl">2010</span>, <span class="va">Year</span> <span class="op">&lt;</span> <span class="fl">2022</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>In_provincial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">B.C.</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Calculate the annual “OUT” migration with the following:</p>
<div class="sourceCode" id="cb573"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_prov</span> <span class="op">&lt;-</span> <span class="va">interprovincial</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">&gt;=</span> <span class="fl">2010</span>, <span class="va">Year</span> <span class="op">&lt;</span> <span class="fl">2022</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Origin</span> <span class="op">==</span> <span class="st">"B.C."</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>Out_provincial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Total</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Join the two dataframes to calculate the “NET” migration.</p>
<div class="sourceCode" id="cb574"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data_net_interprovincial</span> <span class="op">&lt;-</span> <span class="va">in_prov</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">out_prov</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Year"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Net_provincial <span class="op">=</span> <span class="va">In_provincial</span> <span class="op">-</span> <span class="va">Out_provincial</span><span class="op">)</span></span></code></pre></div>
<p>Create a plot.</p>
<div class="sourceCode" id="cb575"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">plot_data_net_interprovincial</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Net_provincial</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Net interprovincial migration in B.C."</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Annually from 2010 to 2021"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<img src="fig/rmd-13-unnamed-chunk-15-1.png" width="576" style="display: block; margin: auto;"></details>
</blockquote>
</div>
<div id="total-net-migration-from-2010-to-2021-annually" class="section level3" number="13.6.3">
<h3>
<span class="header-section-number">13.6.3</span> Total net migration from 2010 to 2021 annually<a class="anchor" aria-label="anchor" href="#total-net-migration-from-2010-to-2021-annually"><i class="fas fa-link"></i></a>
</h3>
<p>How did the inter-provincial migration differ from the international migration?
What about total net migration?</p>
<p><strong>Plot the total net migration that occurred in B.C. from 2010 to 2021 annually.</strong></p>
<p>What dataframes can you combine to calculate the total net migration?
Check out <strong>Chapter 8: Joining Related Data</strong>, for a refresher on joining data.</p>
<blockquote>
<details><summary>
Possible Solution
</summary><p>Combine the two plot_data dataframes that you created in the previous steps.
Join by year.
Then, calculate the total net migration by summing the international and inter-provincial.</p>
<div class="sourceCode" id="cb576"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data_total_net_migration</span> <span class="op">&lt;-</span> <span class="va">plot_data_net_international</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">plot_data_net_interprovincial</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Year"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Net_migration <span class="op">=</span> <span class="va">Net_international</span> <span class="op">+</span> <span class="va">Net_provincial</span><span class="op">)</span></span></code></pre></div>
<p>Create a plot.</p>
<div class="sourceCode" id="cb577"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">plot_data_total_net_migration</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Net_migration</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Total net migration in B.C."</span>,</span>
<span>        subtitle <span class="op">=</span> <span class="st">"Annually from 2010 to 2021"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<img src="fig/rmd-13-unnamed-chunk-17-1.png" width="576" style="display: block; margin: auto;"></details>
</blockquote>
<!-- ** stop here ** -->
<!-- Below contains some additional examples but is incomplete and un-formatted. -->
<!-- On average, does provincial/international migration vary depending on the time of year. -->
<!-- Is there a quarter that has more international migration, more provincial migration, more out/in, etc.  -->
<!-- Note: international IN = Immigrants + Net non-permanent Residents + Returning emigrants -->
<!--       international OUT = Emigrants + Net temporary emigrants -->
<!-- ```{r} -->
<!--  mig2 <- mig %>%  -->
<!--   mutate(in_inter = Immigrants + Net_non_permanent_residents + Returning_emigrants, -->
<!--          out_inter = Emigrants + Net_temporary_emigrants) -->
<!-- mig2 %>% -->
<!--   group_by(Quarter) %>% -->
<!--   summarize(avg_out_prov = mean(out_prov), -->
<!--             avg_out_inter = mean(out_inter), -->
<!--             avg_in_prov = mean(in_prov), -->
<!--             avg_in_inter = mean(in_inter), -->
<!--             avg_net_mig = mean(total_net)) -->
<!-- ## Q2, Q3 (Apr-Sep) more people coming and going -->
<!-- ## Q1, Q4 (Oct-March) lower time for migration in the year -->
<!-- ## Does not differ much whether provincial, international, in or out -->
<!-- ``` -->
<!-- plot over the years to see if the trends align with the averages; make separate charts for in/out, prov/international -->
<!-- ```{r} -->
<!-- ## have to prep data for ploting -->
<!-- plot_data_1 <- mig2 %>% -->
<!--   select(Year, Quarter, out_prov, out_inter, in_prov, in_inter, total_net) %>% -->
<!--   pivot_longer(-c(Year, Quarter), names_to = "mig_type", values_to = "values") %>% -->
<!--   mutate(Quarter = factor(Quarter, levels = c(1, 2 ,3, 4))) -->
<!-- ggplot(data = plot_data_1, mapping = aes(x = Year, y = values)) + -->
<!--   geom_line(aes(color = Quarter)) +  -->
<!--   facet_wrap(facets = vars(mig_type)) -->
<!-- ``` -->
<!-- plot data from last 5 years -->
<!-- ```{r} -->
<!-- ggplot(data = plot_data_1 %>% filter(Year >= 2018), mapping = aes(x = Year, y = values)) + -->
<!--   geom_line(aes(color = Quarter)) +  -->
<!--   facet_wrap(facets = vars(mig_type)) -->
<!-- ## due to timing of pandemic, Q2/Q3 which normally have the most migration, had the least international in migration in 2020 -->
<!-- ## so far in 2022, there has been a big recovery in international in - surpassing pre-pandemic numbers, similar increases seen in prov mig (in & out) -->
<!-- ``` -->
<!-- what regions most impacted by pandemic with regards to prov migration -->
<!-- (Atlantic Provinces = N.L., P.E.I., N.S., N.B.; -->
<!--  Central Canada = Que., Ont.; -->
<!--  Prairie Provinces = Man., Sask., Alta.; -->
<!--  West Coast = B.C.; -->
<!--  Northern Territories = Y.T., N.W.T., Nvt.) -->
<!-- ```{r, interprov-all} -->
<!-- ## find the net provincial migration for all provinces -->
<!-- net_prov <- interprov %>% -->
<!--   rename(Out = Total) %>% -->
<!--   pivot_longer(-c(Year, Quarter, Origin, Out), names_to = "Destination", values_to = "n") %>% -->
<!--   group_by(Year, Quarter, Destination) %>% -->
<!--   mutate("In" = sum(n)) %>% -->
<!--   filter(Origin == Destination) %>% -->
<!--   mutate(Net = In - Out) %>% -->
<!--   ## note province and destination are now equal, only need to retain one,  -->
<!--   ## remember to ungroup -->
<!--   ungroup() %>% -->
<!--   select(Year, Quarter, Province = Origin, Out, In, Net) -->
<!-- net_regions <- net_prov %>% -->
<!--   mutate(Region = case_when(Province %in% c("N.L.", "P.E.I.", "N.S.", "N.B.") ~ "Atlantic Provinces", -->
<!--                             Province %in% c("Que.", "Ont.") ~ "Central Canada", -->
<!--                             Province %in% c("Man.", "Sask.", "Alta.") ~ "Prairie Provinces", -->
<!--                             Province == "B.C." ~ "West Coast", -->
<!--                             Province %in% c("Y.T.", "N.W.T.", "Nvt.") ~ "Northern Territories")) %>% -->
<!--   group_by(Year, Quarter, Region) %>% -->
<!--   summarize(In = sum(In), -->
<!--             Out = sum(Out), -->
<!--             Net = sum(Net)) -->
<!-- net_reg_annual <- net_regions %>% -->
<!--   group_by(Year, Region) %>% -->
<!--   summarize(In = sum(In), -->
<!--             Out = sum(Out), -->
<!--             Net = sum(Net)) -->
<!-- ``` -->
<!-- plot -->
<!-- ```{r} -->
<!-- ## filter 2010-2021 -->
<!-- ggplot(net_reg_annual %>% filter(Year >= 2010, Year < 2022), aes(x = Year, y = Net)) + -->
<!--   geom_line(aes(color = Region)) + -->
<!--   geom_point() -->
<!-- ## Atlantic provinces/BC saw a increases in net mig 2020=2021 -->
<!-- ## Central Canada saw a big decrease in net mig 2020-2021 -->
<!-- ``` -->
<!-- What regions were BC-ians coming, going to, did the main origin, destination change over the pandemic? -->
<!-- ```{r} -->
<!-- ## -->
<!-- main_orig <- interprov %>% -->
<!--   filter(Year >= 2012) %>% -->
<!--   select(Year, Quarter, Origin, B.C.) %>% -->
<!--   group_by(Year, Origin) %>% -->
<!--   summarize(values = sum(B.C.)) %>% -->
<!--   mutate(max = max(values)) %>% -->
<!--   filter(values == max) -->
<!-- #Main destination province over last 10 years -->
<!-- main_dest <- interprov %>% -->
<!--   filter(Origin == "B.C.", Year >= 2012) %>% -->
<!--   group_by(Year, Origin) %>% -->
<!--   summarize_all(sum) %>% -->
<!--   pivot_longer(-c(Year, Quarter, Origin, Total), names_to = "province", values_to = "values") %>% -->
<!--   mutate(max = max(values)) %>% -->
<!--   filter(values == max) -->
<!-- ## least origin, least destination -->
<!-- ``` -->

</div>
</div>
</div>






  <div class="chapter-nav">
<div class="prev"><a href="seeking-help-from-others-with-reprex.html"><span class="header-section-number">13</span> Seeking Help from Others with reprex</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#bc-migration-patterns">BC Migration Patterns</a></li>
<li><a class="nav-link" href="#setting-up-your-r-session"><span class="header-section-number">13.3</span> Setting up your R session</a></li>
<li><a class="nav-link" href="#loading-data"><span class="header-section-number">13.4</span> Loading data</a></li>
<li><a class="nav-link" href="#reviewing-the-data"><span class="header-section-number">13.5</span> Reviewing the data</a></li>
<li>
<a class="nav-link" href="#analyzing-your-data"><span class="header-section-number">13.6</span> Analyzing your data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#net-international-migration-from-2010-to-2021-annually"><span class="header-section-number">13.6.1</span> Net international migration from 2010 to 2021 annually</a></li>
<li><a class="nav-link" href="#net-inter-provincial-migration-from-2010-to-2021-annually"><span class="header-section-number">13.6.2</span> Net inter-provincial migration from 2010 to 2021 annually</a></li>
<li><a class="nav-link" href="#total-net-migration-from-2010-to-2021-annually"><span class="header-section-number">13.6.3</span> Total net migration from 2010 to 2021 annually</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/bcgov/ds-intro-to-r-2-day/blob/master/14-mini-analysis.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/bcgov/ds-intro-to-r-2-day/edit/master/14-mini-analysis.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>BC Migration Patterns</strong>" was written by . It was last built on 2023-01-22.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
