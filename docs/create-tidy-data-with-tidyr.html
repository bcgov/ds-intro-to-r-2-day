<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Create Tidy Data with tidyr | Introduction to Data Science using R Workshop</title>
  <meta name="description" content="This book contains materials for a 2 day Introduction to R workshop" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Create Tidy Data with tidyr | Introduction to Data Science using R Workshop" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book contains materials for a 2 day Introduction to R workshop" />
  <meta name="github-repo" content="bcgov/ds-intro-to-r-2-day" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Create Tidy Data with tidyr | Introduction to Data Science using R Workshop" />
  
  <meta name="twitter:description" content="This book contains materials for a 2 day Introduction to R workshop" />
  

<meta name="author" content="Sam Albers, Stephanie Hazlitt, Genevieve Perkins &amp; Andy Teucher" />


<meta name="date" content="2020-05-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dataframe-manipulation-with-dplyr.html"/>
<link rel="next" href="introduction-to-bcdata-package.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Data Science using R Workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Introduction to R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#before-starting-the-workshop"><i class="fa fa-check"></i><b>1.2</b> Before Starting The Workshop</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#introduction-to-rstudio"><i class="fa fa-check"></i><b>1.3</b> Introduction to RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#work-flow-within-rstudio"><i class="fa fa-check"></i><b>1.4</b> Work flow within RStudio</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#introduction-to-r"><i class="fa fa-check"></i><b>1.5</b> Introduction to R</a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#using-r-as-a-calculator"><i class="fa fa-check"></i><b>1.6</b> Using R as a calculator</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#mathematical-functions"><i class="fa fa-check"></i><b>1.7</b> Mathematical functions</a></li>
<li class="chapter" data-level="1.8" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#comparing-things"><i class="fa fa-check"></i><b>1.8</b> Comparing things</a></li>
<li class="chapter" data-level="1.9" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#variables-and-assignment"><i class="fa fa-check"></i><b>1.9</b> Variables and assignment</a></li>
<li class="chapter" data-level="1.10" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#vectorization"><i class="fa fa-check"></i><b>1.10</b> Vectorization</a></li>
<li class="chapter" data-level="1.11" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#managing-your-environment"><i class="fa fa-check"></i><b>1.11</b> Managing your environment</a></li>
<li class="chapter" data-level="1.12" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#r-packages"><i class="fa fa-check"></i><b>1.12</b> R Packages</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="seeking-help-in-r.html"><a href="seeking-help-in-r.html"><i class="fa fa-check"></i><b>2</b> Seeking Help in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="seeking-help-in-r.html"><a href="seeking-help-in-r.html#reading-help-files"><i class="fa fa-check"></i><b>2.1</b> Reading Help files</a></li>
<li class="chapter" data-level="2.2" data-path="seeking-help-in-r.html"><a href="seeking-help-in-r.html#special-operators"><i class="fa fa-check"></i><b>2.2</b> Special Operators</a></li>
<li class="chapter" data-level="2.3" data-path="seeking-help-in-r.html"><a href="seeking-help-in-r.html#getting-help-on-packages"><i class="fa fa-check"></i><b>2.3</b> Getting help on packages</a></li>
<li class="chapter" data-level="2.4" data-path="seeking-help-in-r.html"><a href="seeking-help-in-r.html#when-you-kind-of-remember-the-function"><i class="fa fa-check"></i><b>2.4</b> When you kind of remember the function</a></li>
<li class="chapter" data-level="2.5" data-path="seeking-help-in-r.html"><a href="seeking-help-in-r.html#when-you-have-no-idea-where-to-begin"><i class="fa fa-check"></i><b>2.5</b> When you have no idea where to begin</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="project-management-with-rstudio.html"><a href="project-management-with-rstudio.html"><i class="fa fa-check"></i><b>3</b> Project Management With RStudio</a>
<ul>
<li class="chapter" data-level="3.1" data-path="project-management-with-rstudio.html"><a href="project-management-with-rstudio.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="project-management-with-rstudio.html"><a href="project-management-with-rstudio.html#a-possible-solution"><i class="fa fa-check"></i><b>3.2</b> A possible solution</a></li>
<li class="chapter" data-level="3.3" data-path="project-management-with-rstudio.html"><a href="project-management-with-rstudio.html#best-practices-for-project-organization"><i class="fa fa-check"></i><b>3.3</b> Best practices for project organization</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="project-management-with-rstudio.html"><a href="project-management-with-rstudio.html#treat-data-as-read-only"><i class="fa fa-check"></i><b>3.3.1</b> Treat data as read only</a></li>
<li class="chapter" data-level="3.3.2" data-path="project-management-with-rstudio.html"><a href="project-management-with-rstudio.html#data-cleaning"><i class="fa fa-check"></i><b>3.3.2</b> Data Cleaning</a></li>
<li class="chapter" data-level="3.3.3" data-path="project-management-with-rstudio.html"><a href="project-management-with-rstudio.html#treat-generated-output-as-disposable"><i class="fa fa-check"></i><b>3.3.3</b> Treat generated output as disposable</a></li>
<li class="chapter" data-level="3.3.4" data-path="project-management-with-rstudio.html"><a href="project-management-with-rstudio.html#separate-function-definition-and-application"><i class="fa fa-check"></i><b>3.3.4</b> Separate function definition and application</a></li>
<li class="chapter" data-level="3.3.5" data-path="project-management-with-rstudio.html"><a href="project-management-with-rstudio.html#version-control"><i class="fa fa-check"></i><b>3.3.5</b> Version Control</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>4</b> Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-structures.html"><a href="data-structures.html#the-readr-package"><i class="fa fa-check"></i><b>4.1</b> The <em>readr</em> package</a></li>
<li class="chapter" data-level="4.2" data-path="data-structures.html"><a href="data-structures.html#data-types"><i class="fa fa-check"></i><b>4.2</b> Data Types</a></li>
<li class="chapter" data-level="4.3" data-path="data-structures.html"><a href="data-structures.html#vectors-and-type-coercion"><i class="fa fa-check"></i><b>4.3</b> Vectors and Type Coercion</a></li>
<li class="chapter" data-level="4.4" data-path="data-structures.html"><a href="data-structures.html#data-frames"><i class="fa fa-check"></i><b>4.4</b> Data Frames</a></li>
<li class="chapter" data-level="4.5" data-path="data-structures.html"><a href="data-structures.html#factors"><i class="fa fa-check"></i><b>4.5</b> Factors</a></li>
<li class="chapter" data-level="4.6" data-path="data-structures.html"><a href="data-structures.html#lists"><i class="fa fa-check"></i><b>4.6</b> Lists</a></li>
<li class="chapter" data-level="4.7" data-path="data-structures.html"><a href="data-structures.html#matrices"><i class="fa fa-check"></i><b>4.7</b> Matrices</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exploring-data-frames.html"><a href="exploring-data-frames.html"><i class="fa fa-check"></i><b>5</b> Exploring Data Frames</a>
<ul>
<li class="chapter" data-level="5.1" data-path="exploring-data-frames.html"><a href="exploring-data-frames.html#realistic-example"><i class="fa fa-check"></i><b>5.1</b> Realistic example</a></li>
<li class="chapter" data-level="5.2" data-path="exploring-data-frames.html"><a href="exploring-data-frames.html#basic-subsetting"><i class="fa fa-check"></i><b>5.2</b> Basic subsetting</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="exploring-data-frames.html"><a href="exploring-data-frames.html#selecting-rows"><i class="fa fa-check"></i><b>5.2.1</b> Selecting rows</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="creating-publication-quality-graphics-with-ggplot2.html"><a href="creating-publication-quality-graphics-with-ggplot2.html"><i class="fa fa-check"></i><b>6</b> Creating Publication-Quality Graphics with ggplot2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="creating-publication-quality-graphics-with-ggplot2.html"><a href="creating-publication-quality-graphics-with-ggplot2.html#layers"><i class="fa fa-check"></i><b>6.1</b> Layers</a></li>
<li class="chapter" data-level="6.2" data-path="creating-publication-quality-graphics-with-ggplot2.html"><a href="creating-publication-quality-graphics-with-ggplot2.html#transformations-and-statistics"><i class="fa fa-check"></i><b>6.2</b> Transformations and statistics</a></li>
<li class="chapter" data-level="6.3" data-path="creating-publication-quality-graphics-with-ggplot2.html"><a href="creating-publication-quality-graphics-with-ggplot2.html#multi-panel-figures"><i class="fa fa-check"></i><b>6.3</b> Multi-panel figures</a></li>
<li class="chapter" data-level="6.4" data-path="creating-publication-quality-graphics-with-ggplot2.html"><a href="creating-publication-quality-graphics-with-ggplot2.html#modifying-text"><i class="fa fa-check"></i><b>6.4</b> Modifying text</a></li>
<li class="chapter" data-level="6.5" data-path="creating-publication-quality-graphics-with-ggplot2.html"><a href="creating-publication-quality-graphics-with-ggplot2.html#exporting-the-plot"><i class="fa fa-check"></i><b>6.5</b> Exporting the plot</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dataframe-manipulation-with-dplyr.html"><a href="dataframe-manipulation-with-dplyr.html"><i class="fa fa-check"></i><b>7</b> Dataframe Manipulation with dplyr</a>
<ul>
<li class="chapter" data-level="7.1" data-path="dataframe-manipulation-with-dplyr.html"><a href="dataframe-manipulation-with-dplyr.html#the-dplyr-package"><i class="fa fa-check"></i><b>7.1</b> The <code>dplyr</code> package</a></li>
<li class="chapter" data-level="7.2" data-path="dataframe-manipulation-with-dplyr.html"><a href="dataframe-manipulation-with-dplyr.html#using-select"><i class="fa fa-check"></i><b>7.2</b> Using select()</a></li>
<li class="chapter" data-level="7.3" data-path="dataframe-manipulation-with-dplyr.html"><a href="dataframe-manipulation-with-dplyr.html#using-filter"><i class="fa fa-check"></i><b>7.3</b> Using filter()</a></li>
<li class="chapter" data-level="7.4" data-path="dataframe-manipulation-with-dplyr.html"><a href="dataframe-manipulation-with-dplyr.html#using-filter-with-pipes"><i class="fa fa-check"></i><b>7.4</b> Using filter() with pipes</a></li>
<li class="chapter" data-level="7.5" data-path="dataframe-manipulation-with-dplyr.html"><a href="dataframe-manipulation-with-dplyr.html#using-group_by-and-summarize"><i class="fa fa-check"></i><b>7.5</b> Using group_by() and summarize()</a></li>
<li class="chapter" data-level="7.6" data-path="dataframe-manipulation-with-dplyr.html"><a href="dataframe-manipulation-with-dplyr.html#using-summarize"><i class="fa fa-check"></i><b>7.6</b> Using summarize()</a></li>
<li class="chapter" data-level="7.7" data-path="dataframe-manipulation-with-dplyr.html"><a href="dataframe-manipulation-with-dplyr.html#count"><i class="fa fa-check"></i><b>7.7</b> count()</a></li>
<li class="chapter" data-level="7.8" data-path="dataframe-manipulation-with-dplyr.html"><a href="dataframe-manipulation-with-dplyr.html#using-mutate"><i class="fa fa-check"></i><b>7.8</b> Using mutate()</a></li>
<li class="chapter" data-level="7.9" data-path="dataframe-manipulation-with-dplyr.html"><a href="dataframe-manipulation-with-dplyr.html#connect-mutate-with-logical-groupings-ifelse"><i class="fa fa-check"></i><b>7.9</b> Connect mutate with logical groupings: ifelse</a></li>
<li class="chapter" data-level="7.10" data-path="dataframe-manipulation-with-dplyr.html"><a href="dataframe-manipulation-with-dplyr.html#combining-dplyr-and-ggplot2"><i class="fa fa-check"></i><b>7.10</b> Combining <code>dplyr</code> and <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.11" data-path="dataframe-manipulation-with-dplyr.html"><a href="dataframe-manipulation-with-dplyr.html#other-great-resources"><i class="fa fa-check"></i><b>7.11</b> Other great resources</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="create-tidy-data-with-tidyr.html"><a href="create-tidy-data-with-tidyr.html"><i class="fa fa-check"></i><b>8</b> Create Tidy Data with tidyr</a>
<ul>
<li class="chapter" data-level="8.1" data-path="create-tidy-data-with-tidyr.html"><a href="create-tidy-data-with-tidyr.html#getting-started"><i class="fa fa-check"></i><b>8.1</b> Getting started</a></li>
<li class="chapter" data-level="8.2" data-path="create-tidy-data-with-tidyr.html"><a href="create-tidy-data-with-tidyr.html#from-wide-to-long-format-with-pivot_longer"><i class="fa fa-check"></i><b>8.2</b> From wide to long format with pivot_longer()</a></li>
<li class="chapter" data-level="8.3" data-path="create-tidy-data-with-tidyr.html"><a href="create-tidy-data-with-tidyr.html#from-long-to-intermediate-format-with-pivot_wider"><i class="fa fa-check"></i><b>8.3</b> From long to intermediate format with pivot_wider()</a></li>
<li class="chapter" data-level="8.4" data-path="create-tidy-data-with-tidyr.html"><a href="create-tidy-data-with-tidyr.html#other-great-resources-1"><i class="fa fa-check"></i><b>8.4</b> Other great resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="introduction-to-bcdata-package.html"><a href="introduction-to-bcdata-package.html"><i class="fa fa-check"></i><b>9</b> Introduction to bcdata package</a></li>
<li class="chapter" data-level="10" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html"><i class="fa fa-check"></i><b>10</b> Data analysis reports</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#literate-programming"><i class="fa fa-check"></i><b>10.1</b> Literate programming</a></li>
<li class="chapter" data-level="10.2" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#example-of-using-r-markdown-in-the-bc-government"><i class="fa fa-check"></i><b>10.2</b> Example of Using R Markdown in the BC Government</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#documentation"><i class="fa fa-check"></i><b>10.2.1</b> Documentation</a></li>
<li class="chapter" data-level="10.2.2" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#teaching"><i class="fa fa-check"></i><b>10.2.2</b> Teaching</a></li>
<li class="chapter" data-level="10.2.3" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#presentation"><i class="fa fa-check"></i><b>10.2.3</b> Presentation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#creating-an-r-markdown-file"><i class="fa fa-check"></i><b>10.3</b> Creating an R Markdown file</a></li>
<li class="chapter" data-level="10.4" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#basic-components-of-r-markdown"><i class="fa fa-check"></i><b>10.4</b> Basic components of R Markdown</a></li>
<li class="chapter" data-level="10.5" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#markdown"><i class="fa fa-check"></i><b>10.5</b> Markdown</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#a-bit-more-markdown"><i class="fa fa-check"></i><b>10.5.1</b> A bit more Markdown</a></li>
<li class="chapter" data-level="10.5.2" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#r-code-chunks"><i class="fa fa-check"></i><b>10.5.2</b> R code chunks</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#how-r-markdown-gets-compiled"><i class="fa fa-check"></i><b>10.6</b> How R Markdown gets compiled</a></li>
<li class="chapter" data-level="10.7" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#chunk-options"><i class="fa fa-check"></i><b>10.7</b> Chunk options</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#global-options"><i class="fa fa-check"></i><b>10.7.1</b> Global options</a></li>
<li class="chapter" data-level="10.7.2" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#formatting-figures"><i class="fa fa-check"></i><b>10.7.2</b> Formatting figures</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#inline-r-code"><i class="fa fa-check"></i><b>10.8</b> Inline R code</a></li>
<li class="chapter" data-level="10.9" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#other-outputs-word-pdf-and-more"><i class="fa fa-check"></i><b>10.9</b> Other outputs: Word, PDF and more…</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#a-note-about-rmd-outputs"><i class="fa fa-check"></i><b>10.9.1</b> A note about Rmd outputs</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="data-analysis-reports.html"><a href="data-analysis-reports.html#resources"><i class="fa fa-check"></i><b>10.10</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="applications-of-r-markdown.html"><a href="applications-of-r-markdown.html"><i class="fa fa-check"></i><b>11</b> Applications of R Markdown</a></li>
<li class="chapter" data-level="12" data-path="seeking-help-from-others-with-reprex.html"><a href="seeking-help-from-others-with-reprex.html"><i class="fa fa-check"></i><b>12</b> Seeking Help from Others with reprex</a>
<ul>
<li class="chapter" data-level="12.1" data-path="seeking-help-from-others-with-reprex.html"><a href="seeking-help-from-others-with-reprex.html#help-people-help-you---reprex"><i class="fa fa-check"></i><b>12.1</b> Help People Help You - reprex</a></li>
<li class="chapter" data-level="12.2" data-path="seeking-help-from-others-with-reprex.html"><a href="seeking-help-from-others-with-reprex.html#other-helpful-resources"><i class="fa fa-check"></i><b>12.2</b> Other Helpful Resources</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Data Science using R Workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="create-tidy-data-with-tidyr" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Create Tidy Data with tidyr</h1>
<p>People who work with data often want to reshape their dataframes from ‘wide’ to ‘longer’
layouts, or vice-versa. The ‘long’ layout or format is where:</p>
<ul>
<li>each column is a variable</li>
<li>each row is an observation</li>
</ul>
<p>In the purely ‘long’ (or ‘longest’) format, you usually have 1 column for the observed variable and the other columns are ID variables.</p>
<p>For the ‘wide’ format each row is often a site/subject/patient and you have
multiple observation variables containing the same type of data. These can be
either repeated observations over time, or observation of multiple variables (or
a mix of both). You may find data input may be simpler or some other
applications may prefer the ‘wide’ format. However, many of <code>R</code>‘s functions have
been designed assuming you have ’longer’ formatted data. This tutorial will help you
efficiently transform your data shape regardless of original format.</p>
<p><img src="fig/08-tidyr-fig1.png" /></p>
<p>Long and wide dataframe layouts mainly affect readability. For humans, the wide format is often more intuitive since we can often see more of the data on the screen due
to its shape. However, the long format is more machine readable and is closer
to the formatting of databases. The ID variables in our dataframes are similar to
the fields in a database and observed variables are like the database values.</p>
<div id="getting-started" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Getting started</h2>
<p>First install the packages if you haven’t already done so (you probably
installed dplyr in the previous lesson):</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="create-tidy-data-with-tidyr.html#cb355-1"></a><span class="co">#install.packages(&quot;tidyr&quot;)</span></span>
<span id="cb355-2"><a href="create-tidy-data-with-tidyr.html#cb355-2"></a><span class="co">#install.packages(&quot;dplyr&quot;)</span></span></code></pre></div>
<p>Load the packages</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="create-tidy-data-with-tidyr.html#cb356-1"></a><span class="kw">library</span>(<span class="st">&quot;tidyr&quot;</span>)</span>
<span id="cb356-2"><a href="create-tidy-data-with-tidyr.html#cb356-2"></a><span class="kw">library</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb356-3"><a href="create-tidy-data-with-tidyr.html#cb356-3"></a><span class="kw">library</span>(<span class="st">&quot;readr&quot;</span>)</span></code></pre></div>
<p>First, lets look at the structure of our original gapminder dataframe:</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="create-tidy-data-with-tidyr.html#cb357-1"></a>gapminder &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/gapminder_data.csv&quot;</span>)</span></code></pre></div>
<pre><code>Parsed with column specification:
cols(
  country = col_character(),
  year = col_double(),
  pop = col_double(),
  continent = col_character(),
  lifeExp = col_double(),
  gdpPercap = col_double()
)</code></pre>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="create-tidy-data-with-tidyr.html#cb359-1"></a>gapminder</span></code></pre></div>
<pre><code># A tibble: 1,704 x 6
   country      year      pop continent lifeExp gdpPercap
   &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 Afghanistan  1952  8425333 Asia         28.8      779.
 2 Afghanistan  1957  9240934 Asia         30.3      821.
 3 Afghanistan  1962 10267083 Asia         32.0      853.
 4 Afghanistan  1967 11537966 Asia         34.0      836.
 5 Afghanistan  1972 13079460 Asia         36.1      740.
 6 Afghanistan  1977 14880372 Asia         38.4      786.
 7 Afghanistan  1982 12881816 Asia         39.9      978.
 8 Afghanistan  1987 13867957 Asia         40.8      852.
 9 Afghanistan  1992 16317921 Asia         41.7      649.
10 Afghanistan  1997 22227415 Asia         41.8      635.
# … with 1,694 more rows</code></pre>
<blockquote>
<h2 id="challenge-1-6">Challenge 1</h2>
<p>Is gapminder a purely long, purely wide, or some intermediate format?</p>
<blockquote>
<h2 id="solution-to-challenge-1-4">Solution to Challenge 1</h2>
<p>The original gapminder data.frame is in an intermediate format. It is not
purely long since it had multiple observation variables
(<code>pop</code>,<code>lifeExp</code>,<code>gdpPercap</code>).</p>
</blockquote>
</blockquote>
<p>Sometimes, as with the gapminder dataset, we have multiple types of observed
data. It is somewhere in between the purely ‘long’ and ‘wide’ data formats. We
have 3 “ID variables” (<code>continent</code>, <code>country</code>, <code>year</code>) and 3 “Observation
variables” (<code>pop</code>,<code>lifeExp</code>,<code>gdpPercap</code>). This intermediate format can be
preferred despite not having ALL observations in 1 column given that all 3
observation variables have different units. There are few operations that would
need us to make this dataframe any longer (i.e. 4 ID variables and 1
Observation variable).</p>
<p>While using many of the functions in R, which are often vector based, you
usually do not want to do mathematical operations on values with different
units. For example, using the purely long format, a single mean for all of the
values of population, life expectancy, and GDP would not be meaningful since it
would return the mean of values with 3 incompatible units. The solution is that
we first manipulate the data either by grouping (see the lesson on <code>dplyr</code>), or
we change the structure of the dataframe. <strong>Note:</strong> Some plotting functions in
R actually work better in the wide format data.</p>
</div>
<div id="from-wide-to-long-format-with-pivot_longer" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> From wide to long format with pivot_longer()</h2>
<p>Until now, we’ve been using the nicely formatted original gapminder dataset, but
‘real’ data (i.e. our own research data) will never be so well organized. Here
let’s start with the wide formatted version of the gapminder dataset.</p>
<p>We’ll load the data file and look at it.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="create-tidy-data-with-tidyr.html#cb361-1"></a>gap_wide &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/gapminder_wide.csv&quot;</span>)</span></code></pre></div>
<pre><code>Parsed with column specification:
cols(
  .default = col_double(),
  continent = col_character(),
  country = col_character()
)</code></pre>
<pre><code>See spec(...) for full column specifications.</code></pre>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="create-tidy-data-with-tidyr.html#cb364-1"></a>gap_wide</span></code></pre></div>
<pre><code># A tibble: 142 x 38
   continent country pop_1952 lifeExp_1952 gdpPercap_1952 pop_1957 lifeExp_1957
   &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;        &lt;dbl&gt;          &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;
 1 Asia      Afghan…  8425333         28.8           779.  9240934         30.3
 2 Europe    Albania  1282697         55.2          1601.  1476505         59.3
 3 Africa    Algeria  9279525         43.1          2449. 10270856         45.7
 4 Africa    Angola   4232095         30.0          3521.  4561361         32.0
 5 Americas  Argent… 17876956         62.5          5911. 19610538         64.4
 6 Oceania   Austra…  8691212         69.1         10040.  9712569         70.3
 7 Europe    Austria  6927772         66.8          6137.  6965860         67.5
 8 Asia      Bahrain   120447         50.9          9867.   138655         53.8
 9 Asia      Bangla… 46886859         37.5           684. 51365468         39.3
10 Europe    Belgium  8730405         68            8343.  8989111         69.2
# … with 132 more rows, and 31 more variables: gdpPercap_1957 &lt;dbl&gt;,
#   pop_1962 &lt;dbl&gt;, lifeExp_1962 &lt;dbl&gt;, gdpPercap_1962 &lt;dbl&gt;, pop_1967 &lt;dbl&gt;,
#   lifeExp_1967 &lt;dbl&gt;, gdpPercap_1967 &lt;dbl&gt;, pop_1972 &lt;dbl&gt;,
#   lifeExp_1972 &lt;dbl&gt;, gdpPercap_1972 &lt;dbl&gt;, pop_1977 &lt;dbl&gt;,
#   lifeExp_1977 &lt;dbl&gt;, gdpPercap_1977 &lt;dbl&gt;, pop_1982 &lt;dbl&gt;,
#   lifeExp_1982 &lt;dbl&gt;, gdpPercap_1982 &lt;dbl&gt;, pop_1987 &lt;dbl&gt;,
#   lifeExp_1987 &lt;dbl&gt;, gdpPercap_1987 &lt;dbl&gt;, pop_1992 &lt;dbl&gt;,
#   lifeExp_1992 &lt;dbl&gt;, gdpPercap_1992 &lt;dbl&gt;, pop_1997 &lt;dbl&gt;,
#   lifeExp_1997 &lt;dbl&gt;, gdpPercap_1997 &lt;dbl&gt;, pop_2002 &lt;dbl&gt;,
#   lifeExp_2002 &lt;dbl&gt;, gdpPercap_2002 &lt;dbl&gt;, pop_2007 &lt;dbl&gt;,
#   lifeExp_2007 &lt;dbl&gt;, gdpPercap_2007 &lt;dbl&gt;</code></pre>
<p><img src="fig/08-tidyr-fig2.png" /></p>
<p>To change this very wide dataframe layout back to our nice, intermediate (or longer) layout, we will use one of the two available <code>pivot</code> functions from the <code>tidyr</code> package. To convert from wide to a longer format, we will use the <code>pivot_longer()</code> function. <code>pivot_longer()</code> makes datasets longer by increasing the number of rows and decreasing the number of columns, or ‘lengthening’ your observation variables into a single variable.</p>
<p><img src="fig/08-tidyr-fig3.png" /></p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="create-tidy-data-with-tidyr.html#cb366-1"></a>gap_long &lt;-<span class="st"> </span>gap_wide <span class="op">%&gt;%</span></span>
<span id="cb366-2"><a href="create-tidy-data-with-tidyr.html#cb366-2"></a><span class="st">  </span><span class="kw">pivot_longer</span>(</span>
<span id="cb366-3"><a href="create-tidy-data-with-tidyr.html#cb366-3"></a>    <span class="dt">cols =</span> pop_<span class="dv">1952</span><span class="op">:</span>gdpPercap_<span class="dv">2007</span>,</span>
<span id="cb366-4"><a href="create-tidy-data-with-tidyr.html#cb366-4"></a>    <span class="dt">names_to =</span> <span class="st">&quot;obstype_year&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;obs_values&quot;</span></span>
<span id="cb366-5"><a href="create-tidy-data-with-tidyr.html#cb366-5"></a>  )</span>
<span id="cb366-6"><a href="create-tidy-data-with-tidyr.html#cb366-6"></a>gap_long</span></code></pre></div>
<pre><code># A tibble: 5,112 x 4
   continent country     obstype_year   obs_values
   &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;               &lt;dbl&gt;
 1 Asia      Afghanistan pop_1952        8425333  
 2 Asia      Afghanistan lifeExp_1952         28.8
 3 Asia      Afghanistan gdpPercap_1952      779. 
 4 Asia      Afghanistan pop_1957        9240934  
 5 Asia      Afghanistan lifeExp_1957         30.3
 6 Asia      Afghanistan gdpPercap_1957      821. 
 7 Asia      Afghanistan pop_1962       10267083  
 8 Asia      Afghanistan lifeExp_1962         32.0
 9 Asia      Afghanistan gdpPercap_1962      853. 
10 Asia      Afghanistan pop_1967       11537966  
# … with 5,102 more rows</code></pre>
<p>Here we have used piping syntax which is similar to what we were doing in the
previous lesson with dplyr. In fact, these are compatible and you can use a mix
of tidyr and dplyr functions by piping them together.</p>
<p>We first provide to <code>pivot_longer()</code> a vector of column names that will be
pivoted into longer format. We could type out all the observation variables, but
as in the <code>select()</code> function, we can use the <code>:</code> operator to select our desired variables.
<code>pivot_longer()</code> also allows the alternative syntax of using the <code>-</code> symbol to
identify which variables are not to be pivoted (i.e. ID variables).</p>
<p>The next arguments to <code>pivot_longer()</code> are <code>names_to</code> for naming the column that
will contain the new ID variable (<code>obstype_year</code>) and <code>values_to</code> for naming the
new amalgamated observation variable (<code>obs_value</code>). We supply these new column
names as strings.</p>
<p><img src="fig/08-tidyr-fig4.png" /></p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="create-tidy-data-with-tidyr.html#cb368-1"></a>gap_long &lt;-<span class="st"> </span>gap_wide <span class="op">%&gt;%</span></span>
<span id="cb368-2"><a href="create-tidy-data-with-tidyr.html#cb368-2"></a><span class="st">  </span><span class="kw">pivot_longer</span>(</span>
<span id="cb368-3"><a href="create-tidy-data-with-tidyr.html#cb368-3"></a>    <span class="dt">cols =</span> <span class="kw">c</span>(<span class="op">-</span>continent, <span class="op">-</span>country),</span>
<span id="cb368-4"><a href="create-tidy-data-with-tidyr.html#cb368-4"></a>    <span class="dt">names_to =</span> <span class="st">&quot;obstype_year&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;obs_values&quot;</span></span>
<span id="cb368-5"><a href="create-tidy-data-with-tidyr.html#cb368-5"></a>  )</span>
<span id="cb368-6"><a href="create-tidy-data-with-tidyr.html#cb368-6"></a>gap_long</span></code></pre></div>
<pre><code># A tibble: 5,112 x 4
   continent country     obstype_year   obs_values
   &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;               &lt;dbl&gt;
 1 Asia      Afghanistan pop_1952        8425333  
 2 Asia      Afghanistan lifeExp_1952         28.8
 3 Asia      Afghanistan gdpPercap_1952      779. 
 4 Asia      Afghanistan pop_1957        9240934  
 5 Asia      Afghanistan lifeExp_1957         30.3
 6 Asia      Afghanistan gdpPercap_1957      821. 
 7 Asia      Afghanistan pop_1962       10267083  
 8 Asia      Afghanistan lifeExp_1962         32.0
 9 Asia      Afghanistan gdpPercap_1962      853. 
10 Asia      Afghanistan pop_1967       11537966  
# … with 5,102 more rows</code></pre>
<p>That may seem trivial with this particular dataframe, but sometimes you have 1
ID variable and 40 observation variables with irregular variable names. The
flexibility is a huge time saver!</p>
<p>Now <code>obstype_year</code> actually contains 2 pieces of information, the observation
type (<code>pop</code>,<code>lifeExp</code>, or <code>gdpPercap</code>) and the <code>year</code>. We can use the
<code>separate()</code> function to split the character strings into multiple variables</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="create-tidy-data-with-tidyr.html#cb370-1"></a>gap_long &lt;-<span class="st"> </span>gap_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb370-2"><a href="create-tidy-data-with-tidyr.html#cb370-2"></a><span class="st">    </span><span class="kw">separate</span>(obstype_year, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&#39;obs_type&#39;</span>, <span class="st">&#39;year&#39;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb370-3"><a href="create-tidy-data-with-tidyr.html#cb370-3"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw">as.numeric</span>(year))</span></code></pre></div>
<blockquote>
<h2 id="challenge-2-5">Challenge 2</h2>
<p>Using <code>gap_long</code>, calculate the mean life expectancy, population, and gdpPercap for each continent.
<strong>Hint:</strong> use the <code>group_by()</code> and <code>summarize()</code> functions we learned in the <code>dplyr</code> lesson</p>
<blockquote>
<h2 id="solution-to-challenge-2-5">Solution to Challenge 2</h2>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="create-tidy-data-with-tidyr.html#cb371-1"></a>gap_long <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(continent, obs_type) <span class="op">%&gt;%</span></span>
<span id="cb371-2"><a href="create-tidy-data-with-tidyr.html#cb371-2"></a><span class="st">   </span><span class="kw">summarize</span>(<span class="dt">means=</span><span class="kw">mean</span>(obs_values))</span></code></pre></div>
<pre><code># A tibble: 15 x 3
# Groups:   continent [5]
  continent obs_type       means
  &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;
1 Africa    gdpPercap     2194. 
2 Africa    lifeExp         48.9
3 Africa    pop        9916003. 
4 Americas  gdpPercap     7136. 
5 Americas  lifeExp         64.7
6 Americas  pop       24504795. 
7 Asia      gdpPercap     7902. 
8 Asia      lifeExp         60.1
9 Asia      pop       77038722. 
10 Europe    gdpPercap    14469. 
11 Europe    lifeExp         71.9
12 Europe    pop       17169765. 
13 Oceania   gdpPercap    18622. 
14 Oceania   lifeExp         74.3
15 Oceania   pop        8874672. </code></pre>
</blockquote>
</blockquote>
</div>
<div id="from-long-to-intermediate-format-with-pivot_wider" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> From long to intermediate format with pivot_wider()</h2>
<p>It is always good to check work. So, let’s use the second <code>pivot</code> function, <code>pivot_wider()</code>, to ‘widen’ our observation variables back out. <code>pivot_wider()</code> is the opposite of <code>pivot_longer()</code>, making a dataset wider by increasing the number of columns and decreasing the number of rows. We can use <code>pivot_wider()</code> to pivot or reshape our <code>gap_long</code> to the original intermediate format or the widest format. Let’s start with the intermediate format.</p>
<p>The <code>pivot_wider()</code> function takes <code>names_from</code> and <code>values_from</code> arguments.</p>
<p>To <code>names_from</code> we supply the column name whose contents will be pivoted into new
output columns in the widened dataframe. The corresponding values will be added
from the column named in the <code>values_from</code> argument.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="create-tidy-data-with-tidyr.html#cb373-1"></a>gap_normal &lt;-<span class="st"> </span>gap_long <span class="op">%&gt;%</span></span>
<span id="cb373-2"><a href="create-tidy-data-with-tidyr.html#cb373-2"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> obs_type, <span class="dt">values_from =</span> obs_values)</span>
<span id="cb373-3"><a href="create-tidy-data-with-tidyr.html#cb373-3"></a><span class="kw">dim</span>(gap_normal)</span></code></pre></div>
<pre><code>[1] 1704    6</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="create-tidy-data-with-tidyr.html#cb375-1"></a><span class="kw">dim</span>(gapminder)</span></code></pre></div>
<pre><code>[1] 1704    6</code></pre>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="create-tidy-data-with-tidyr.html#cb377-1"></a><span class="kw">names</span>(gap_normal)</span></code></pre></div>
<pre><code>[1] &quot;continent&quot; &quot;country&quot;   &quot;year&quot;      &quot;pop&quot;       &quot;lifeExp&quot;   &quot;gdpPercap&quot;</code></pre>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="create-tidy-data-with-tidyr.html#cb379-1"></a><span class="kw">names</span>(gapminder)</span></code></pre></div>
<pre><code>[1] &quot;country&quot;   &quot;year&quot;      &quot;pop&quot;       &quot;continent&quot; &quot;lifeExp&quot;   &quot;gdpPercap&quot;</code></pre>
<p>Now we’ve got an intermediate dataframe <code>gap_normal</code> with the same dimensions as
the original <code>gapminder</code>, but the order of the variables is different. Let’s fix
that before checking if they are <code>all.equal()</code>.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="create-tidy-data-with-tidyr.html#cb381-1"></a>gap_normal &lt;-<span class="st"> </span>gap_normal <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb381-2"><a href="create-tidy-data-with-tidyr.html#cb381-2"></a><span class="st">    </span><span class="kw">select</span>(country, year, pop, continent, lifeExp, gdpPercap) </span>
<span id="cb381-3"><a href="create-tidy-data-with-tidyr.html#cb381-3"></a><span class="kw">all_equal</span>(gap_normal, gapminder)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="create-tidy-data-with-tidyr.html#cb383-1"></a>gap_normal</span></code></pre></div>
<pre><code># A tibble: 1,704 x 6
   country      year      pop continent lifeExp gdpPercap
   &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 Afghanistan  1952  8425333 Asia         28.8      779.
 2 Afghanistan  1957  9240934 Asia         30.3      821.
 3 Afghanistan  1962 10267083 Asia         32.0      853.
 4 Afghanistan  1967 11537966 Asia         34.0      836.
 5 Afghanistan  1972 13079460 Asia         36.1      740.
 6 Afghanistan  1977 14880372 Asia         38.4      786.
 7 Afghanistan  1982 12881816 Asia         39.9      978.
 8 Afghanistan  1987 13867957 Asia         40.8      852.
 9 Afghanistan  1992 16317921 Asia         41.7      649.
10 Afghanistan  1997 22227415 Asia         41.8      635.
# … with 1,694 more rows</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="create-tidy-data-with-tidyr.html#cb385-1"></a>gapminder</span></code></pre></div>
<pre><code># A tibble: 1,704 x 6
   country      year      pop continent lifeExp gdpPercap
   &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 Afghanistan  1952  8425333 Asia         28.8      779.
 2 Afghanistan  1957  9240934 Asia         30.3      821.
 3 Afghanistan  1962 10267083 Asia         32.0      853.
 4 Afghanistan  1967 11537966 Asia         34.0      836.
 5 Afghanistan  1972 13079460 Asia         36.1      740.
 6 Afghanistan  1977 14880372 Asia         38.4      786.
 7 Afghanistan  1982 12881816 Asia         39.9      978.
 8 Afghanistan  1987 13867957 Asia         40.8      852.
 9 Afghanistan  1992 16317921 Asia         41.7      649.
10 Afghanistan  1997 22227415 Asia         41.8      635.
# … with 1,694 more rows</code></pre>
<p>We’re almost there, the original was sorted by <code>country</code>, then
<code>year</code>.</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="create-tidy-data-with-tidyr.html#cb387-1"></a>gap_normal &lt;-<span class="st"> </span>gap_normal <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(country, year)</span>
<span id="cb387-2"><a href="create-tidy-data-with-tidyr.html#cb387-2"></a><span class="kw">all_equal</span>(gap_normal, gapminder)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<p>That’s great! We’ve gone from the longest format back to the intermediate and we
didn’t introduce any errors in our code.</p>
<p>Now let’s convert the long all the way back to the wide. In the wide format, we
will keep country and continent as ID variables and pivot the observations
across the 3 metrics (<code>pop</code>,<code>lifeExp</code>,<code>gdpPercap</code>) and time (<code>year</code>). First we
need to create appropriate labels for all our new variables (time*metric
combinations) and we also need to unify our ID variables to simplify the process
of defining <code>gap_wide</code>.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="create-tidy-data-with-tidyr.html#cb389-1"></a>gap_temp &lt;-<span class="st"> </span>gap_long <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unite</span>(var_ID, continent, country, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb389-2"><a href="create-tidy-data-with-tidyr.html#cb389-2"></a>gap_temp</span></code></pre></div>
<pre><code># A tibble: 5,112 x 4
   var_ID           obs_type   year obs_values
   &lt;chr&gt;            &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1 Asia_Afghanistan pop        1952  8425333  
 2 Asia_Afghanistan lifeExp    1952       28.8
 3 Asia_Afghanistan gdpPercap  1952      779. 
 4 Asia_Afghanistan pop        1957  9240934  
 5 Asia_Afghanistan lifeExp    1957       30.3
 6 Asia_Afghanistan gdpPercap  1957      821. 
 7 Asia_Afghanistan pop        1962 10267083  
 8 Asia_Afghanistan lifeExp    1962       32.0
 9 Asia_Afghanistan gdpPercap  1962      853. 
10 Asia_Afghanistan pop        1967 11537966  
# … with 5,102 more rows</code></pre>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="create-tidy-data-with-tidyr.html#cb391-1"></a>gap_temp &lt;-<span class="st"> </span>gap_long <span class="op">%&gt;%</span></span>
<span id="cb391-2"><a href="create-tidy-data-with-tidyr.html#cb391-2"></a><span class="st">    </span><span class="kw">unite</span>(ID_var, continent, country, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb391-3"><a href="create-tidy-data-with-tidyr.html#cb391-3"></a><span class="st">    </span><span class="kw">unite</span>(var_names, obs_type, year, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb391-4"><a href="create-tidy-data-with-tidyr.html#cb391-4"></a>gap_temp</span></code></pre></div>
<pre><code># A tibble: 5,112 x 3
   ID_var           var_names      obs_values
   &lt;chr&gt;            &lt;chr&gt;               &lt;dbl&gt;
 1 Asia_Afghanistan pop_1952        8425333  
 2 Asia_Afghanistan lifeExp_1952         28.8
 3 Asia_Afghanistan gdpPercap_1952      779. 
 4 Asia_Afghanistan pop_1957        9240934  
 5 Asia_Afghanistan lifeExp_1957         30.3
 6 Asia_Afghanistan gdpPercap_1957      821. 
 7 Asia_Afghanistan pop_1962       10267083  
 8 Asia_Afghanistan lifeExp_1962         32.0
 9 Asia_Afghanistan gdpPercap_1962      853. 
10 Asia_Afghanistan pop_1967       11537966  
# … with 5,102 more rows</code></pre>
<p>Using <code>unite()</code> we now have a single ID variable which is a combination of
<code>continent</code>,<code>country</code>,and we have defined variable names. We’re now ready to
pipe in <code>pivot_wider()</code></p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="create-tidy-data-with-tidyr.html#cb393-1"></a>gap_wide_new &lt;-<span class="st"> </span>gap_long <span class="op">%&gt;%</span></span>
<span id="cb393-2"><a href="create-tidy-data-with-tidyr.html#cb393-2"></a><span class="st">  </span><span class="kw">unite</span>(ID_var, continent, country, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb393-3"><a href="create-tidy-data-with-tidyr.html#cb393-3"></a><span class="st">  </span><span class="kw">unite</span>(var_names, obs_type, year, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb393-4"><a href="create-tidy-data-with-tidyr.html#cb393-4"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> var_names, <span class="dt">values_from =</span> obs_values)</span>
<span id="cb393-5"><a href="create-tidy-data-with-tidyr.html#cb393-5"></a>gap_wide_new</span></code></pre></div>
<pre><code># A tibble: 142 x 37
   ID_var pop_1952 lifeExp_1952 gdpPercap_1952 pop_1957 lifeExp_1957
   &lt;chr&gt;     &lt;dbl&gt;        &lt;dbl&gt;          &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;
 1 Asia_…  8425333         28.8           779.  9240934         30.3
 2 Europ…  1282697         55.2          1601.  1476505         59.3
 3 Afric…  9279525         43.1          2449. 10270856         45.7
 4 Afric…  4232095         30.0          3521.  4561361         32.0
 5 Ameri… 17876956         62.5          5911. 19610538         64.4
 6 Ocean…  8691212         69.1         10040.  9712569         70.3
 7 Europ…  6927772         66.8          6137.  6965860         67.5
 8 Asia_…   120447         50.9          9867.   138655         53.8
 9 Asia_… 46886859         37.5           684. 51365468         39.3
10 Europ…  8730405         68            8343.  8989111         69.2
# … with 132 more rows, and 31 more variables: gdpPercap_1957 &lt;dbl&gt;,
#   pop_1962 &lt;dbl&gt;, lifeExp_1962 &lt;dbl&gt;, gdpPercap_1962 &lt;dbl&gt;, pop_1967 &lt;dbl&gt;,
#   lifeExp_1967 &lt;dbl&gt;, gdpPercap_1967 &lt;dbl&gt;, pop_1972 &lt;dbl&gt;,
#   lifeExp_1972 &lt;dbl&gt;, gdpPercap_1972 &lt;dbl&gt;, pop_1977 &lt;dbl&gt;,
#   lifeExp_1977 &lt;dbl&gt;, gdpPercap_1977 &lt;dbl&gt;, pop_1982 &lt;dbl&gt;,
#   lifeExp_1982 &lt;dbl&gt;, gdpPercap_1982 &lt;dbl&gt;, pop_1987 &lt;dbl&gt;,
#   lifeExp_1987 &lt;dbl&gt;, gdpPercap_1987 &lt;dbl&gt;, pop_1992 &lt;dbl&gt;,
#   lifeExp_1992 &lt;dbl&gt;, gdpPercap_1992 &lt;dbl&gt;, pop_1997 &lt;dbl&gt;,
#   lifeExp_1997 &lt;dbl&gt;, gdpPercap_1997 &lt;dbl&gt;, pop_2002 &lt;dbl&gt;,
#   lifeExp_2002 &lt;dbl&gt;, gdpPercap_2002 &lt;dbl&gt;, pop_2007 &lt;dbl&gt;,
#   lifeExp_2007 &lt;dbl&gt;, gdpPercap_2007 &lt;dbl&gt;</code></pre>
<blockquote>
<h2 id="challenge-3-5">Challenge 3</h2>
<p>Take this 1 step further and create a <code>gap_ludicrously_wide</code> format data by pivoting over countries, year and the 3 metrics?
<strong>Hint</strong> this new dataframe should only have 5 rows.</p>
<blockquote>
<h2 id="solution-to-challenge-3-5">Solution to Challenge 3</h2>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="create-tidy-data-with-tidyr.html#cb395-1"></a>gap_ludicrously_wide &lt;-<span class="st"> </span>gap_long <span class="op">%&gt;%</span></span>
<span id="cb395-2"><a href="create-tidy-data-with-tidyr.html#cb395-2"></a><span class="st">   </span><span class="kw">unite</span>(var_names, obs_type, year, country, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb395-3"><a href="create-tidy-data-with-tidyr.html#cb395-3"></a><span class="st">   </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> var_names, <span class="dt">values_from =</span> obs_values)</span></code></pre></div>
</blockquote>
</blockquote>
<p>Now we have a great ‘wide’ format dataframe, but the <code>ID_var</code> could be more
usable, let’s separate it into 2 variables with <code>separate()</code></p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="create-tidy-data-with-tidyr.html#cb396-1"></a>gap_wide_betterID &lt;-<span class="st"> </span><span class="kw">separate</span>(gap_wide_new, ID_var, <span class="kw">c</span>(<span class="st">&quot;continent&quot;</span>, <span class="st">&quot;country&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb396-2"><a href="create-tidy-data-with-tidyr.html#cb396-2"></a>gap_wide_betterID &lt;-<span class="st"> </span>gap_long <span class="op">%&gt;%</span></span>
<span id="cb396-3"><a href="create-tidy-data-with-tidyr.html#cb396-3"></a><span class="st">    </span><span class="kw">unite</span>(ID_var, continent, country, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb396-4"><a href="create-tidy-data-with-tidyr.html#cb396-4"></a><span class="st">    </span><span class="kw">unite</span>(var_names, obs_type, year, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb396-5"><a href="create-tidy-data-with-tidyr.html#cb396-5"></a><span class="st">    </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> var_names, <span class="dt">values_from =</span> obs_values) <span class="op">%&gt;%</span></span>
<span id="cb396-6"><a href="create-tidy-data-with-tidyr.html#cb396-6"></a><span class="st">    </span><span class="kw">separate</span>(ID_var, <span class="kw">c</span>(<span class="st">&quot;continent&quot;</span>,<span class="st">&quot;country&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb396-7"><a href="create-tidy-data-with-tidyr.html#cb396-7"></a>gap_wide_betterID</span></code></pre></div>
<pre><code># A tibble: 142 x 38
   continent country pop_1952 lifeExp_1952 gdpPercap_1952 pop_1957 lifeExp_1957
   &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;        &lt;dbl&gt;          &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;
 1 Asia      Afghan…  8425333         28.8           779.  9240934         30.3
 2 Europe    Albania  1282697         55.2          1601.  1476505         59.3
 3 Africa    Algeria  9279525         43.1          2449. 10270856         45.7
 4 Africa    Angola   4232095         30.0          3521.  4561361         32.0
 5 Americas  Argent… 17876956         62.5          5911. 19610538         64.4
 6 Oceania   Austra…  8691212         69.1         10040.  9712569         70.3
 7 Europe    Austria  6927772         66.8          6137.  6965860         67.5
 8 Asia      Bahrain   120447         50.9          9867.   138655         53.8
 9 Asia      Bangla… 46886859         37.5           684. 51365468         39.3
10 Europe    Belgium  8730405         68            8343.  8989111         69.2
# … with 132 more rows, and 31 more variables: gdpPercap_1957 &lt;dbl&gt;,
#   pop_1962 &lt;dbl&gt;, lifeExp_1962 &lt;dbl&gt;, gdpPercap_1962 &lt;dbl&gt;, pop_1967 &lt;dbl&gt;,
#   lifeExp_1967 &lt;dbl&gt;, gdpPercap_1967 &lt;dbl&gt;, pop_1972 &lt;dbl&gt;,
#   lifeExp_1972 &lt;dbl&gt;, gdpPercap_1972 &lt;dbl&gt;, pop_1977 &lt;dbl&gt;,
#   lifeExp_1977 &lt;dbl&gt;, gdpPercap_1977 &lt;dbl&gt;, pop_1982 &lt;dbl&gt;,
#   lifeExp_1982 &lt;dbl&gt;, gdpPercap_1982 &lt;dbl&gt;, pop_1987 &lt;dbl&gt;,
#   lifeExp_1987 &lt;dbl&gt;, gdpPercap_1987 &lt;dbl&gt;, pop_1992 &lt;dbl&gt;,
#   lifeExp_1992 &lt;dbl&gt;, gdpPercap_1992 &lt;dbl&gt;, pop_1997 &lt;dbl&gt;,
#   lifeExp_1997 &lt;dbl&gt;, gdpPercap_1997 &lt;dbl&gt;, pop_2002 &lt;dbl&gt;,
#   lifeExp_2002 &lt;dbl&gt;, gdpPercap_2002 &lt;dbl&gt;, pop_2007 &lt;dbl&gt;,
#   lifeExp_2007 &lt;dbl&gt;, gdpPercap_2007 &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="create-tidy-data-with-tidyr.html#cb398-1"></a><span class="kw">all_equal</span>(gap_wide, gap_wide_betterID)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<p>There and back again!</p>
</div>
<div id="other-great-resources-1" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Other great resources</h2>
<ul>
<li><a href="http://r4ds.had.co.nz/index.html">R for Data Science</a></li>
<li><a href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">Data Wrangling Cheat sheet</a></li>
<li><a href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html">Introduction to tidyr</a></li>
<li><a href="https://www.rstudio.com/resources/webinars/data-wrangling-with-r-and-rstudio/">Data wrangling with R and RStudio</a></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dataframe-manipulation-with-dplyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-to-bcdata-package.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
